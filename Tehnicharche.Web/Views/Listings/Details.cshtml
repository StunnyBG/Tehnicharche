@model Tehnicharche.ViewModels.ListingDetailsViewModel
@using System.Security.Claims

<h1 class="mb-4 text-break">@Model.Title</h1>

<div class="card shadow-sm p-4">

    <div class="row">

        <div class="col-md-4 text-center">
            <img src="@Model.ImageUrl"
                 class="w-100 h-100 rounded shadow-sm object-fit-contain"
                 style="max-height: 300px; object-fit: cover;"
                 onerror="this.onerror=null;this.src='/images/placeholder.png';" />
        </div>

        <div class="col-md-8">

            <p class="display-6 fw-bold text-dark mb-3">
                @Model.Price €
            </p>

            <p>
                <strong>Category:</strong> @Model.CategoryName
            </p>

            <p>
                <strong>Location:</strong>
                @Model.RegionName
                @if (!string.IsNullOrWhiteSpace(Model.CityName))
                {
                    <span> - @Model.CityName</span>
                }
            </p>

            <hr />

            <p>@Model.Description</p>

            <hr />

            <h5>Contact</h5>

            <p>
                <strong>Email:</strong>
                <a href="mailto:@Model.CreatorEmail">
                    @Model.CreatorEmail
                </a>
            </p>

            @if (!string.IsNullOrWhiteSpace(Model.CreatorPhoneNumber))
            {
                <p>
                    <strong>Phone:</strong>
                    <a href="tel:@Model.CreatorPhoneNumber">
                        @Model.CreatorPhoneNumber
                    </a>
                </p>
            }

            <div class="mt-4">
                @{
                    var currentUserId = User.FindFirstValue(ClaimTypes.NameIdentifier);
                    var isOwner = !string.IsNullOrEmpty(currentUserId)
                    && currentUserId == Model.CreatorId;
                }

                @if (isOwner)
                {
                    <a class="btn btn-warning me-2"
                       asp-action="Edit"
                       asp-route-id="@Model.Id">
                        Edit
                    </a>

                    <a class="btn btn-danger me-2"
                       asp-action="Delete"
                       asp-route-id="@Model.Id">
                        Delete
                    </a>
                }

                <a class="btn btn-outline-secondary"
                   asp-action="Index">
                    Back
                </a>
            </div>

        </div>
    </div>
</div>
